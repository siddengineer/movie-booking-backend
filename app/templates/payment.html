<!DOCTYPE html>
<html>
<head>
    <title>Movie Booking Payment</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body style="font-family: Arial; text-align: center; margin-top: 100px;">

    <h1>Complete Your Payment ðŸŽ¬</h1>

    <p>Booking ID: {{ booking_id }}</p>
    <p>Amount: â‚¹{{ amount }}</p>

    <button id="pay-btn" style="
        padding: 15px 30px;
        font-size: 18px;
        background-color: #3399cc;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 5px;">
        Pay Now
    </button>

    <script>
        var options = {
            "key": "{{ razorpay_key }}", 
            "amount": "{{ amount}}", 
            "currency": "INR",
            "name": "Movie Booking",
            "description": "Ticket Payment",
            "order_id": "{{ order_id }}",

            "handler": function (response) {

                fetch("/bookings/verify-payment", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        booking_id: {{ booking_id }},
                        razorpay_payment_id: response.razorpay_payment_id,
                        razorpay_order_id: response.razorpay_order_id,
                        razorpay_signature: response.razorpay_signature
                    })
                })
                .then(res => res.json())
                .then(data => {
                    alert("Payment Successful âœ…");
                    window.location.reload();
                });

            },

            "theme": {
                "color": "#3399cc"
            }

        };

        var rzp = new Razorpay(options);

        document.getElementById("pay-btn").onclick = function(e){
            rzp.open();
            e.preventDefault();
        }
    </script>

</body>
</html>